---
title: "STAT 331 Portfolio"
author: "Joaquin Arredondo"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an A.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1
# Lab 3 - Q2
teacher_evals <- read_csv(here("Week 3", "Lab 3", "teacher_evals.csv"))
```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2
# Lab 2 - Q1
surveys <- read_csv(here::here("week2","lab2","surveys.csv"))
```

-   `xlsx`

```{r}
#| label: wd-1-xlsx
# Checkin 2
ages_xlsx <- read_excel("Ages_Data/ages.xlsx")
```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1
# Lab 3 - Q5

teacher_evals_clean <-
  teacher_evals |>
  filter(no_participants >= 10) |>
  select(course_id, teacher_id, question_no, no_participants, resp_share,
         SET_score_avg, percent_failed_cur, academic_degree, seniority, gender) |>
  rename(sex = gender) |>
  mutate(
    across(c(course_id, teacher_id), as.character),
    question_no        = as.integer(question_no),
    academic_degree    = as.factor(academic_degree),
    seniority          = as.integer(seniority),
    sex                = as.factor(sex),
    SET_score_avg      = as.numeric(SET_score_avg),
    percent_failed_cur = as.numeric(percent_failed_cur),
    resp_share         = as.numeric(resp_share),
    no_participants    = as.integer(no_participants)
  )
```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
# Lab 3 - Q7 (Revised)

instructors <- teacher_evals_clean |>
  select(-c(course_id, question_no, SET_score_avg, percent_failed_cur, resp_share, no_participants)) |>
  distinct(teacher_id, .keep_all = TRUE) 

instructors |> count(academic_degree)
instructors |>  
  summarize(
    avg_seniority = mean(seniority,  na.rm = TRUE),
    n_male = sum(sex == "male"),
    n_female = sum(sex == "female")
  ) 
```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3
# Lab 3 - Q9 (Revised)

teacher_evals_clean |> 
  select(contains("_id"), question_no) |>
  group_by(teacher_id, course_id) |>
  summarise(
    n_combo = n_distinct(question_no),
    .groups = "drop"
  ) |>
  filter(n_combo == 9) |>
  nrow()
```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1
# Lab 3 - Q9

teacher_evals_clean |> 
  select(contains("_id"), question_no) |>
  group_by(teacher_id, course_id) |>
  summarise(
    n_combo = n_distinct(question_no),
    .groups = "drop"
  ) |>
  filter(n_combo == 9) |>
  nrow()
```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-2
# Lab 3 - Q11

teacher_evals_clean |>
  filter(seniority == 1) |>
  distinct(teacher_id, course_id, percent_failed_cur) |>
  group_by(teacher_id) |>
  summarise(
    avg_failing = mean(percent_failed_cur, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(avg_failing == max(avg_failing) | avg_failing == min(avg_failing))
```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character
# Lab 3 - Q12

teacher_evals_clean |> 
  filter(academic_degree %in% c("dr", "prof")) |>
  group_by(teacher_id, seniority, sex) |>
  summarise(
    avg_eval_resp = mean(resp_share, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(avg_eval_resp == max(avg_eval_resp) | avg_eval_resp == min(avg_eval_resp))
```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string
# Lab 5 - Finding Membership & Platnumber in database

get_fit_now_check_in |> 
  left_join(get_fit_now_member,
            by = join_by(membership_id == id)) |>
  left_join(person,
            by = join_by(person_id == id)) |>
  left_join(drivers_license,
            by = join_by(license_id == id)) |>
  filter (
    str_starts(membership_id, "48Z"),
    check_in_date == 20180109,
    membership_status == "gold",
    str_detect(plate_number, "H42W")
    ) 
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
# Lab 5 - Revised to include Lubridate Functions to filter dates

get_fit_now_check_in |> 
  filter(check_in_date == ymd("2018-01-09")) |>
  left_join(get_fit_now_member,
            by = join_by(membership_id == id)) |>
  left_join(person,
            by = join_by(person_id == id)) |>
  left_join(drivers_license,
            by = join_by(license_id == id)) |>
  filter (
    str_starts(membership_id, "48Z"),
    membership_status == "gold",
    str_detect(plate_number, "H42W")
    ) 
```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1
# Challenge 3 - Q1

teacher_evals_compare <- teacher_evals |>
  filter(question_no == 903) |>
  mutate(
    SET_level = case_when(
      SET_score_avg >= 4 ~ "excellent",
      TRUE               ~ "standard"
    ),
    sen_level = case_when(
      seniority <= 4 ~ "junior",
      seniority <= 8 ~ "senior",
      TRUE           ~ "very senior"
    )
  ) |>
  select(course_id, SET_level, sen_level)
```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2
# Lab 7 - Q12 ~ made avg_eval_resp

fish_missing_summary <- fish |>
  mutate(
    any_missing = if_any(
      .cols = everything(), 
      .fns = ~ is.na(.x))
    ) |>
  summarise (
    observations_na = sum(any_missing),
    across(
     .cols = everything(), 
     .fns = ~ sum(is.na(.x)), 
     .names = "na_{.col}")
  )
```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1
# Lab 4 - Q7 ~ fct_recode

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2
# Lab 4 - Q7 ~ fct_relevel

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string
# Lab 5 - Crime Scene Inspection (Revised for Portfolio)

gym_clue_stringr <- get_fit_now_member |>
  mutate(
    # Create a new character variable that extracts the first 3 letters of the ID
    id_prefix = str_sub(id, 1, 3),

    # Modify an existing character variable to clean formatting
    membership_status_clean = str_to_title(membership_status)
  ) |>
  filter(
    membership_status == "gold",
    id_prefix == "48Z"
  ) |>
  left_join(person, join_by(person_id == id)) |>
  left_join(drivers_license, join_by(license_id == id)) |>
  filter(str_detect(plate_number, "H42W")) |>
  select(id, person_id, membership_status_clean, id_prefix, plate_number)

gym_clue_stringr
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date
# Lab 5 - Mutating dates to be lubridate

crime_scene_report <- crime_scene_report |>
mutate(date = ymd(date))

facebook_event_checkin <- facebook_event_checkin |>
mutate(date = ymd(date))

get_fit_now_check_in <- get_fit_now_check_in |>
mutate(check_in_date = ymd(check_in_date))
```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1
# Lab 5 - Trying to find primary suspect by combining datasets

get_fit_now_check_in |> 
  filter(check_in_date == ymd("2018-01-09")) |>
  left_join(get_fit_now_member,
            by = join_by(membership_id == id)) |>
  left_join(person,
            by = join_by(person_id == id)) |>
  left_join(drivers_license,
            by = join_by(license_id == id)) |>
  filter (
    str_starts(membership_id, "48Z"),
    membership_status == "gold",
    str_detect(plate_number, "H42W")
    ) 
```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right
# Lab 5 - (Revised) for creating the database for interview x person

interview_person <- right_join(x = person,
                              y = interview,
                              by = join_by(id == person_id)
                    ) |>
                    filter(!is.na(name) ) |>
                    select(person_id,
                           name,
                           transcript)

# Now that it is a right join, interview will be matched with person, but right database is reserved.
# Not every interview will be guaranteed a person, so we must filter out N/A values for person/name.
```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2
# Lab 5 - combining person and interview, wanna keep list of people but I wanna attach interviews if they have it!
# Example of left_join, but person is preserved. 

interview_person <- left_join(x = person,
                              y = interview,
                              by = join_by(id == person_id)
                    )
```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1
# Lab 5 - (Revision)
# inner_join, means that both entries can't be N/A, they must match to be reserved.

suspect_strict <- get_fit_now_check_in |>
  filter(
    check_in_date == ymd("2018-01-09")
    ) |>
  inner_join(get_fit_now_member, 
             by = join_by(membership_id == id)) |>
  inner_join(person, 
             by = join_by(person_id == id)) |>
  inner_join(drivers_license, 
             by = join_by(license_id == id)) |>
  filter(
    str_starts(membership_id, "48Z"),
    membership_status == "gold",
    str_detect(plate_number, "H42W")
  ) |>
  select(person_id, name, membership_id, membership_status, plate_number) |>
  distinct()

suspect_strict

```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2
# Lab 5 - (Revision)
# In this case, if we do a inner join it reserves the same thing we want/need.
# inner joins are gauranteeing there are no people in our rows that contain missing data.

main_suspect <- person |> 
  inner_join(drivers_license,
            by = join_by(license_id == id)) |>
  inner_join(income,
            by = join_by(ssn == ssn)) |>
  inner_join(interview,
            by = join_by(id == person_id)) |>
  inner_join(facebook_event_checkin, 
            by = join_by(id == person_id)) |>
  filter(
    hair_color == "red",
    car_make == "Tesla",
    car_model == "Model S",
    gender == "female",
    height %in% c(65, 66, 67),
    event_name == "SQL Symphony Concert"
  ) 

main_suspect
```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi
# Lab 5 confirming that our main suspect has 0 transcripts and needs to be further investigated or that our 
# previous suspect was lying!

interview |>
  semi_join(main_suspect,
            by = join_by(person_id == id)) |>
  pull(transcript)
```

-   `anti_join()`

```{r}
#| label: wd-6-anti
# Lab 5 ~ List of suspects who did NOT attend the SQL Symphony Concert in Dec 2017 (Revised for Portfolio)

#  Everyone who did attend the concert in Dec 2017
concert_dec17_attendees <- facebook_event_checkin |>
  filter(
    event_name == "SQL Symphony Concert",
    year(date) == 2017,
    month(date) == 12
  )

# People in-person who are NOT in that attendee list
suspects_not_at_concert <- person |>
  anti_join(
    concert_dec17_attendees,
    by = join_by(id == person_id)
  )

suspects_not_at_concert
```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
# Lab 4 - Q7

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(#
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide
# Lab 4 - Q5

median_household_income <- ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(region, study_year) |>
  summarise(
    median_income = median(mhi_2018, na.rm = TRUE), 
    .groups = "drop") |>
  pivot_wider(
    names_from = study_year,
    values_from = median_income,
    names_prefix = "median_income_"
  ) |>
  arrange(desc(median_income_2018))
  median_household_income
```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Lab 3
-   Lab 4
-   Challenge 4
-   Lab 2
-   Lab 2 Challenge

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1
# Lab 4 - Q7

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2
# Lab 3 - Q5

teacher_evals_clean <-
  teacher_evals |>
  select(course_id, teacher_id, question_no, no_participants, resp_share,
         SET_score_avg, percent_failed_cur, academic_degree, seniority, gender) |>
  rename(sex = gender) |>
  filter(no_participants >= 10) |>
  mutate(
    across(c(course_id, teacher_id), as.character),
    question_no        = as.integer(question_no),
    academic_degree    = as.factor(academic_degree),
    seniority          = as.integer(seniority),
    sex                = as.factor(sex),
    SET_score_avg      = as.numeric(SET_score_avg),
    percent_failed_cur = as.numeric(percent_failed_cur),
    resp_share         = as.numeric(resp_share),
    no_participants    = as.integer(no_participants)
  )
```

-   Example of function formatting

```{r}
#| label: r-2-3
# Lab 7 - Q4

rescale_01 <- function(x) {
  if (!is.numeric(x)) {
    stop("Input must be numeric.", call. = FALSE)
  }
  if (length(x) <= 1) {
    stop("Input vector must have more than one value.", call. = FALSE)
  }
  
  r <- range(x, na.rm = TRUE)
  (x - r[1]) / diff(r)
}
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example
# Lab 4 - Q6

ca_childcare |> 
  filter(study_year == 2018) |>
  group_by(region, study_year) |>  
  summarise(
    med_2018_mc_i = median(mc_infant, na.rm = TRUE), 
    .groups = "drop") |>   
  slice_min(med_2018_mc_i)


median_household_income |> slice_min(median_income_2018) 
```

-   Example (function stops)

```{r}
#| label: r-3-function-stops
# Lab 7 - Q4

rescale_01 <- function(x) {
  if (!is.numeric(x)) {
    stop("Input must be numeric.", call. = FALSE)
  }
  if (length(x) <= 1) {
    stop("Input vector must have more than one value.", call. = FALSE)
  }
  
  r <- range(x, na.rm = TRUE)
  (x - r[1]) / diff(r)
}
```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num
# Lab 4 - Q8

ca_childcare |>
  ggplot(aes(x = mhi_2018, y = mc_infant)) +
  geom_point(color = "orange", alpha = 0.6, size = 1.5) +   # orange + transparency
  geom_smooth(method = "lm", color = "darkorange", se = FALSE, size = 0.8) +  # darker line
  labs(
    x = "Median household income (2018 dollars)",
    y = "Weekly full-time median price (Infant, center-based)",
    title = "Income vs. Infant Childcare Costs in California (2008–2018)"
  ) +
  theme(
    aspect.ratio = 1,
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5),
    axis.title.x = element_text(size = 8),
    axis.title.y = element_text(size = 7),
    plot.title = element_text(size = 8, face = "bold"),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
    panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
    panel.background = element_rect(fill = "white")
  )
```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat
# Lab 2 - Q8 (Revised for no tilt)

sex_cols <- c(F = "#6a3d9a", M = "#1f78b4")

ggplot(data = surveys,
       mapping = aes(x = weight, y = sex, color = sex)) +
  geom_jitter(alpha = 0.2, color = "orange3", height = 0.2) +
  geom_boxplot(outlier.shape = NA) +
  scale_color_manual(values = sex_cols) +
  labs(
    title = "Distribution of Rodent Weights by Sex",
    x = "Weight (g)",
    y = "Sex",
    subtitle = NULL
  ) +
  theme(
    plot.title = element_text(face = "bold", color = "purple", size = 18),
    panel.border = element_rect(color = "grey35", fill = NA, linewidth = 0.8)
  )
```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat
# Challenge 3 - Q2

ggplot(data = teacher_evals_compare, 
       mapping = aes(x = sen_level, fill = SET_level)) +
       geom_bar(position = "fill") +
       labs(
         title = "Evaluation of Teachers' Use of Activities",
         x = "Years of Experience",
         y = "Percentage",
         fill = "Evaluation Rating"
       ) +
      scale_fill_manual(values = c("excellent" = "#B695D2", "standard" = "#B68758")) +
      scale_y_continuous(labels = scales::percent) +
      theme(
        legend.position = "top",
        plot.title = element_text(hjust = 0)
      ) +
      theme_bw()
```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date
# Lab 4 - Q7

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(#
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1
# Challenge 2 - (Revised): added a facet to seperate data and make it look clearer side by side & go rid of tilt.

sex_cols <- c(F = "#6a3d9a", M = "#1f78b4")

ggplot(surveys, aes(x = weight, y = species, color = sex)) +
  geom_boxplot(outlier.shape = NA) +
  geom_jitter(alpha = 0.25, height = 0.15) +
  scale_color_manual(values = sex_cols) +
  labs(
    title = "Distribution of Rodent Weights by Species",
    subtitle = "Sex: <span style='color:#6a3d9a;'>Female (F)</span> and <span style='color:#1f78b4;'>Male (M)</span>",
    x = "Weight (g)",
    y = "Species"
  ) +
  theme_bw() +
  theme(
    legend.position = "none",
    plot.subtitle = ggtext::element_markdown()
  ) +
  facet_wrap(~ sex)
```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2
# Lab 4 - Q8 (Revised) ~ changed line to be complementary color and more visable.
# Okabe–Ito palette is a nice pallete thats color-blind friendly! 

ca_childcare |>
  ggplot(aes(x = mhi_2018, y = mc_infant)) +
  geom_point(color = "orange", alpha = 0.6, size = 1.5) +   # orange + transparency
  geom_smooth(method = "lm", color = "darkturquoise", se = FALSE, size = 0.8) +  # darker line
  labs(
    x = "Median household income (2018 dollars)",
    y = "Weekly full-time median price (Infant, center-based)",
    title = "Income vs. Infant Childcare Costs in California (2008–2018)"
  ) +
  theme(
    aspect.ratio = 1,
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5),
    axis.title.x = element_text(size = 8),
    axis.title.y = element_text(size = 7),
    plot.title = element_text(size = 8, face = "bold"),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
    panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
    panel.background = element_rect(fill = "white")
  )
```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3
# Challenge 4 - Q4

summary_table |>
  mutate(region = fct_reorder(region, gap)) |>
  ggplot(aes(x = region, 
             y = gap,
             color = fct_reorder(.f = region,
                                 .x = gap))) +
  geom_point(size = 1) +
  coord_flip() +
  facet_wrap(~age, ncol = 1) +
  labs(
    title = "Price Gap by Region and Age — California, 2018",
    subtitle = "More Negative means Center-based care costs more | Gap = (Family − Center)",
    x = NULL, 
    y = "Weekly Price Gap ($)",
    color = "California Regions"
  ) +
  theme_minimal(base_size = 11) + 
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 5),
    axis.title.x = element_text(size = 8), 
    plot.title = element_text(size = 10, face = "bold"),
    plot.subtitle = element_text(size = 5, face = "italic"),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
    panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
    panel.background = element_rect(fill = "white"),
    legend.position = "none"     
  )
```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4
# Lab 10 - Q3

babies_prop_tab |>
  ggplot(aes(x = factor(n_correct), 
             y = prop)) +
  geom_col() +
  scale_y_continuous(labels = label_percent(accuracy = 1)) +
  labs(
    x = "Number of correctly returned babies",
    y = "Proportion of simulations",
    title = "Distribution of Correct Babies Returned"
  )
```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5
# Lab 4 - Q7

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(#
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1
# Lab 4 - Q7

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(#
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2
# Lab 7 - Q3

fish |>
  mutate(any_missing = if_any(
    .cols = everything(), 
    .fns = ~ is.na(.x))
    ) |>
  filter(any_missing) |>
  count(year, section, trip) |>
  ggplot(aes(x = factor(year), 
             y = n, 
             fill = section)) +
  geom_col(position = "dodge") +
  facet_wrap(~ trip, labeller = label_both) +
  labs(
    x = "Year",
    y = "Observations with Missing Values",
    fill = "Section",
    title = "Missing Values in Blackfoot River Trout Surveys by Year, Section, and Trip"
  ) +
  theme_minimal() +
  coord_flip() +
  theme(
    axis.title.x = element_text(margin = margin(t = 10))
  ) + 
    scale_fill_brewer(palette = "Dark2") 
```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2
# Challenge 4 - Q4 (Revised to include geom_text for portfolio)

summary_table |>
  mutate(region = fct_reorder(region, gap)) |>
  ggplot(aes(x = region, 
             y = gap,
             color = fct_reorder(region, gap))) +
  geom_point(size = 1.8) +
  geom_text(
    aes(label = region),
    hjust = -0.1,
    size = 2.5,
    color = "gray20"
  ) +
  coord_flip() +
  facet_wrap(~age, ncol = 1) +
  labs(
    title = "Price Gap by Region and Age — California, 2018",
    subtitle = "More Negative means Center-based care costs more | Gap = (Family − Center)",
    x = NULL, 
    y = "Weekly Price Gap ($)",
    color = "California Regions"
  ) +
  theme_minimal(base_size = 11) + 
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 5),
    axis.title.x = element_text(size = 8), 
    plot.title = element_text(size = 10, face = "bold"),
    plot.subtitle = element_text(size = 5, face = "italic"),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
    panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
    panel.background = element_rect(fill = "white"),
    legend.position = "none"
  )
```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3
# Lab 10 - Q13

set.seed(6767)

smaller_plot_data <- ci_dat |>
  sample_n(100) |>
  mutate(sim_id = row_number())

ggplot(smaller_plot_data, aes(y = sim_id, 
                              x = slope_estimate)) +
  geom_errorbar(aes(xmin = ci_lower, 
                    xmax = ci_upper, 
                    color = factor(cover))) +
  geom_vline(xintercept = 0.5, 
             linetype = "dashed") +
  scale_color_manual(
    values = c("0" = "hotpink", 
               "1" = "cornflowerblue"),
    labels = c("0" = "Not covered", 
               "1" = "Covered")
  ) +
  labs(
    x = "Slope estimate with 95% CI",
    y = "Simulation index (sample of 100)",
    color = "Coverage",
    title = "Confidence Interval Coverage of the True Slope"
  ) +
  theme_minimal()
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize
# Lab 3 - Q7
instructors <- teacher_evals_clean |>
    select(teacher_id, academic_degree, seniority, sex) |>
    distinct(teacher_id, .keep_all = TRUE) 
instructors |>  count(academic_degree)
instructors |>  
  summarize(
    avg_seniority = mean(seniority,  na.rm = TRUE),
    n_male = sum(sex == "male"),
    n_female = sum(sex == "female")
  ) 
```

-   Example using `across()`

```{r}
#| label: dvs-4-across
# Lab 3 - Q3 (Revised)

instructors <- teacher_evals_clean |>
    select(teacher_id, academic_degree, seniority, sex) |>
    distinct(teacher_id, .keep_all = TRUE)

instructors |>  count(academic_degree)

instructors |>
  summarise(
    across(
      .cols = c(seniority),
      .fns =  c(min = min, 
                max = max, 
                mean = mean, 
                median = median)
    ),
    n_male = sum(sex == "male"),
    n_female = sum(sex == "female"),
  )
```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1
# Lab 3 - Q12

teacher_evals_clean |> 
  filter(academic_degree %in% c("dr", "prof")) |>
  group_by(teacher_id, seniority, sex) |>
  summarise(
    avg_eval_resp = mean(resp_share, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(avg_eval_resp == max(avg_eval_resp) | avg_eval_resp == min(avg_eval_resp))
```

-   Example 2

```{r}
#| label: dvs-5-2
# Lab 4 - Q5

median_household_income <- ca_childcare |>
  filter(study_year %in% c(2008, 2018)) |>
  group_by(region, study_year) |>
  summarise(
    median_income = median(mhi_2018, na.rm = TRUE), 
    .groups = "drop") |>
  pivot_wider(
    names_from = study_year,
    values_from = median_income,
    names_prefix = "median_income_"
  ) |>
  arrange(desc(median_income_2018))
  median_household_income
```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1
# Lab 9 - Q8
fish |>
  map_int(.f = ~ sum(is.na(.x))) |> 
  enframe(name = "Variable", value = "Missing") |> 
  arrange(Missing) |>
  gt() |>
  cols_label(
    Variable = md("**Measurement Variable**"), 
    Missing = md("**Missing Values**")
  ) |>
  tab_header(
    title = md("**Number of Missing Values for Fish Measurements**"),
    subtitle = "Data Collected from 1989 to 2006 on the Blackfoot Fish River in Montana"
  ) |> 
  tab_options(
    table.width = pct(70),
    heading.align = "center"
  ) |>
  data_color(
    columns = `Missing`,
    fn = function(x) {
      case_when(
        x == 0 ~ "#2ECC71",    
        TRUE   ~ "#E74C3C")
    }
  )
```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2
# Lab 9 - Q6
# Used Source: https://gt.rstudio.com/reference/tab_style.html 
evals |>
  select(course_id, teacher_id, question_no, no_participants, 
         resp_share, SET_score_avg, percent_failed_cur, 
         academic_degree, seniority, sex) |>
  mutate(
    across(.cols = course_id:teacher_id, .f = as.character),
    across(.cols = c(academic_degree, sex), .f = as.factor),
    across(.cols = c(question_no, seniority, no_participants), .f = as.integer),
    across(.cols = c(SET_score_avg, percent_failed_cur, resp_share), .f = as.numeric)
  ) |>
  distinct(teacher_id, .keep_all = TRUE) |>
  mutate(
    sen_level = case_when(
      seniority <= 4 ~ "Junior",
      seniority > 4 ~ "Senior"
    ),
    sex = recode(as.character(sex),
      "female" = "Female", 
      "male" = "Male"
    ),
    academic_degree = recode(as.character(academic_degree),
      "no_dgr" = "No Degree",
      "ma"     = "Masters",
      "dr"     = "Doctorate",
      "prof"   = "Tenured Professor"
    )
  ) |>
  pivot_longer(
    cols = c(academic_degree, sen_level, sex),
    names_to = "variable", 
    values_to = "level"
  ) |>
  mutate(variable = recode(variable,
    academic_degree = "Academic Degree",
    sen_level       = "Seniority",
    sex             = "Sex")
  ) |>
  group_by(variable, level) |>
  summarise(n = n(), 
           .groups = "drop_last") |>
  mutate(
    prop = scales::percent(n / sum(n), 
                           accuracy = 0.01) # Changed to include percent
  ) |>
  ungroup() |>
  gt(rowname_col = NULL, 
     groupname_col = "variable") |>  #NOTE: variable defines row groups
  cols_label(
    level = "Demographic",  
    n     = "Count",
    prop  = "%"
  ) |>
  tab_spanner(label = md("**Professors**"), 
              columns = c(n, prop)) |>  # How far it spans via columns
  cols_align("left",  level) |>
  cols_align("right", c(n, prop)) |>
  tab_header(
    title    = md("**Demographics of Professors**"),
    subtitle = "Student Evaluations at the University of Poland, Warsaw in 2020"
  ) |>
  opt_row_striping() |> 
  tab_style(
    style = list(
      cell_fill(color = "gray"),          
      cell_text(weight = "bold")          
    ),
    locations = cells_row_groups() #define where this style will take affect.
  )
```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3
# Lab 9 - Q8
fish |>
  map_int(.f = ~ sum(is.na(.x))) |> 
  enframe(name = "Variable", value = "Missing") |> 
  arrange(Missing) |>
  gt() |>
  cols_label(
    Variable = md("**Measurement Variable**"), 
    Missing = md("**Missing Values**")
  ) |>
  tab_header(
    title = md("**Number of Missing Values for Fish Measurements**"),
    subtitle = "Data Collected from 1989 to 2006 on the Blackfoot Fish River in Montana"
  ) |> 
  tab_options(
    table.width = pct(70),
    heading.align = "center"
  ) |>
  data_color(
    columns = `Missing`,
    fn = function(x) {
      case_when(
        x == 0 ~ "#2ECC71",    
        TRUE   ~ "#E74C3C")
    }
  )
```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1
# Lab 9 - Q8
fish |>
  map_int(.f = ~ sum(is.na(.x))) |> 
  enframe(name = "Variable", value = "Missing") |> 
  arrange(Missing) |>
  gt() |>
  cols_label(
    Variable = md("**Measurement Variable**"), 
    Missing = md("**Missing Values**")
  ) |>
  tab_header(
    title = md("**Number of Missing Values for Fish Measurements**"),
    subtitle = "Data Collected from 1989 to 2006 on the Blackfoot Fish River in Montana"
  ) |> 
  tab_options(
    table.width = pct(70),
    heading.align = "center"
  ) |>
  data_color(
    columns = `Missing`,
    fn = function(x) {
      case_when(
        x == 0 ~ "#2ECC71",    
        TRUE   ~ "#E74C3C")
    }
  )
```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2
# Lab 9 - Q6
# Used Source: https://gt.rstudio.com/reference/tab_style.html 

evals |>
  select(course_id, teacher_id, question_no, no_participants, 
         resp_share, SET_score_avg, percent_failed_cur, 
         academic_degree, seniority, sex) |>
  mutate(
    across(.cols = course_id:teacher_id, .f = as.character),
    across(.cols = c(academic_degree, sex), .f = as.factor),
    across(.cols = c(question_no, seniority, no_participants), .f = as.integer),
    across(.cols = c(SET_score_avg, percent_failed_cur, resp_share), .f = as.numeric)
  ) |>
  distinct(teacher_id, .keep_all = TRUE) |>
  mutate(
    sen_level = case_when(
      seniority <= 4 ~ "Junior",
      seniority > 4 ~ "Senior"
    ),
    sex = recode(as.character(sex),
      "female" = "Female", 
      "male" = "Male"
    ),
    academic_degree = recode(as.character(academic_degree),
      "no_dgr" = "No Degree",
      "ma"     = "Masters",
      "dr"     = "Doctorate",
      "prof"   = "Tenured Professor"
    )
  ) |>
  pivot_longer(
    cols = c(academic_degree, sen_level, sex),
    names_to = "variable", 
    values_to = "level"
  ) |>
  mutate(variable = recode(variable,
    academic_degree = "Academic Degree",
    sen_level       = "Seniority",
    sex             = "Sex")
  ) |>
  group_by(variable, level) |>
  summarise(n = n(), 
           .groups = "drop_last") |>
  mutate(
    prop = scales::percent(n / sum(n), 
                           accuracy = 0.01) # Changed to include percent
  ) |>
  ungroup() |>
  gt(rowname_col = NULL, 
     groupname_col = "variable") |>  #NOTE: variable defines row groups
  cols_label(
    level = "Demographic",  
    n     = "Count",
    prop  = "%"
  ) |>
  tab_spanner(label = md("**Professors**"), 
              columns = c(n, prop)) |>  # How far it spans via columns
  cols_align("left",  level) |>
  cols_align("right", c(n, prop)) |>
  tab_header(
    title    = md("**Demographics of Professors**"),
    subtitle = "Student Evaluations at the University of Poland, Warsaw in 2020"
  ) |>
  opt_row_striping() |> 
  tab_style(
    style = list(
      cell_fill(color = "gray"),          
      cell_text(weight = "bold")          
    ),
    locations = cells_row_groups() #define where this style will take affect.
  )
```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call
# Challenge 4 - Q3
summary_table <- ca_childcare |>
  filter(study_year == 2018) |>
  select(region,
         mc_infant, mc_toddler, mc_preschool,
         mfcc_infant, mfcc_toddler, mfcc_preschool) |>
  pivot_longer(
    cols = c(mc_infant, mc_toddler, mc_preschool,
             mfcc_infant, mfcc_toddler, mfcc_preschool),
    names_to = c("setting","age"),
    names_sep = "_", # kind-age-group _ is the delimiter
    values_to = "price"
  ) |>
  # Change data to make it easier to work with
  mutate(
    setting = recode(setting, mc = "Center", mfcc = "Family"), #change mc and mfcc to be more readible
    age = recode(age,
                 infant = "Infant",
                 toddler = "Toddler",
                 preschool = "Preschool")
  )|> group_by(region, age, setting) |>
  summarise(
    median_price = median(price, na.rm = TRUE), 
    .groups = "drop"
  ) |>
  pivot_wider(
    names_from = setting, 
    values_from = median_price
  ) |>
  mutate(
    gap = Family - Center
  ) |>
  arrange(age, 
          desc(gap)
  )

summary_table |>   
  group_by(age) |>
  slice_min(order_by = gap, n = 3, with_ties = FALSE) |>
  arrange(age, gap) |>
  ungroup()
```

-   using `across()`

```{r}
#| label: pe-1-across

#Lab 7 - Q1
fish_missing_summary <- fish |>
  mutate(
    any_missing = if_any(
      .cols = everything(), 
      .fns = ~ is.na(.x))
    ) |>
  summarise (
    observations_na = sum(any_missing),
    across(
     .cols = everything(), 
     .fns = ~ sum(is.na(.x)), 
     .names = "na_{.col}")
  )
fish_missing_summary
```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1
# Lab 9 - Q8

fish |>
  map_int(.f = ~ sum(is.na(.x))) |> 
  enframe(name = "Variable", value = "Missing") |> 
  arrange(Missing) |>
  gt() |>
  cols_label(
    Variable = md("**Measurement Variable**"), 
    Missing = md("**Missing Values**")
  ) |>
  tab_header(
    title = md("**Number of Missing Values for Fish Measurements**"),
    subtitle = "Data Collected from 1989 to 2006 on the Blackfoot Fish River in Montana"
  ) |> 
  tab_options(
    table.width = pct(70),
    heading.align = "center"
  ) |>
  data_color(
    columns = `Missing`,
    fn = function(x) {
      case_when(
        x == 0 ~ "#2ECC71",    
        TRUE   ~ "#E74C3C")
    }
  )
```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1
# Lab 7 - Q4

rescale_01 <- function(x) {
  if (!is.numeric(x)) {
    stop("Input must be numeric.", call. = FALSE)
  }
  if (length(x) <= 1) {
    stop("Input vector must have more than one value.", call. = FALSE)
  }
  
  r <- range(x, na.rm = TRUE)
  (x - r[1]) / diff(r)
}
```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2
# Lab 8 - Q2

pivot_table <- function(df, row_var, col_var) {
  df |> 
    count({{row_var}},{{col_var}}) |>
    pivot_wider(
      names_from = {{col_var}},
      values_from = n,
      values_fill = 0
    ) |>
    janitor::adorn_totals(where = c("row","col"))
}
```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3
# Challenge 7 - Q4

condition_index <- function(weight, length) {
  if(!is.numeric(weight) | !is.numeric(length)) {
    stop("Both variables must be numeric!")
  }
  ((weight / (length^3)) * 100)
}
```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across
# Lab 9 - Q5

evals |>
  select(course_id, teacher_id, question_no, no_participants, 
         resp_share, SET_score_avg, percent_failed_cur, 
         academic_degree, seniority, sex) |>
  mutate(
    across(.cols = course_id:teacher_id, .f = as.character),
    across(.cols = c(academic_degree, sex), .f = as.factor),
    across(.cols = c(question_no, seniority, no_participants), .f = as.integer),
    across(.cols = c(SET_score_avg, percent_failed_cur, resp_share), .f = as.numeric)
  ) |>
  distinct(teacher_id, .keep_all = TRUE) |>
  mutate(
    sen_level = case_when(
      seniority <= 4 ~ "Junior",
      seniority > 4 ~ "Senior"
    ),
    sex = recode(as.character(sex),
      "female" = "Female", 
      "male" = "Male"
    ),
    academic_degree = recode(as.character(academic_degree),
      "no_dgr" = "No Degree",
      "ma"     = "Masters",
      "dr"     = "Doctorate",
      "prof"   = "Tenured Professor"
    )
  ) |>
  pivot_longer(
    cols = c(academic_degree, sen_level, sex),
    names_to = "variable", 
    values_to = "level"
  ) |>
  mutate(variable = recode(variable,
    academic_degree = "Academic Degree",
    sen_level       = "Seniority",
    sex             = "Sex"
  )) |>
  group_by(variable, level) |>
  summarise(n = n(), 
           .groups = "drop_last") |>
  mutate(
    prop = n / sum(n)
  ) |>
  ungroup() |>
  kable(col.names = c("variable", "level", "n", "prop")) |>
  kable_styling(full_width = FALSE, 
                bootstrap_options = "striped")
```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1
# Lab 9 - Q3
# Found kable_classic 
# https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html

tibble(
  Variable = names(surveys),
  DataType = map_chr(surveys, typeof)
) |>
  arrange(DataType, Variable) |>
  kable(caption = "Data Types in `surveys` dataset") |>
  kable_classic(full_width = FALSE) |>
  column_spec(1, bold = TRUE)
```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2
# Lab 9 - Q4

cleaned_evals <- evals |> 
  map_if(.p = is.character, 
         .f = as.factor) |>
  bind_cols()
```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1
# Challenge 3 - Q2

ggplot(data = teacher_evals_compare, 
       mapping = aes(x = sen_level, fill = SET_level)) +
       geom_bar(position = "fill") +
       labs(
         title = "Evaluation of Teachers' Use of Activities",
         x = "Years of Experience",
         y = "Percentage",
         fill = "Evaluation Rating"
       ) +
      scale_fill_manual(values = c("excellent" = "#B695D2", "standard" = "#B68758")) +
      scale_y_continuous(labels = scales::percent) +
      theme(
        legend.position = "top",
        plot.title = element_text(hjust = 0)
      ) +
      theme_bw()
```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2
# Lab 4 - Q7
library(RColorBrewer)

ca_childcare |>
     pivot_longer(cols = c(mc_infant, mc_toddler, mc_preschool),
               names_to = "age_group",
               values_to = "median_age_group") |>
     mutate(
      age_group = fct_recode(age_group,
        "Infant" = "mc_infant",
        "Toddler" = "mc_toddler",
        "Preschool" = "mc_preschool" ),
      age_group = fct_relevel(age_group, "Infant", "Toddler", "Preschool")) |>
     ggplot(mapping = 
             aes(x = study_year, 
                 y = median_age_group, 
                 color = fct_reorder2(.f = region,
                                      .x = study_year,
                                      .y = median_age_group)
                 )
           ) +
      geom_point(size = 0.8) +
      geom_smooth(method = "loess", span = 0.9, size = 0.6) +
      facet_grid(~age_group) +
      scale_color_manual(values = brewer.pal(10, "BrBG")) +
      labs(#
        x = "Study Year",
        y = NULL, 
        title = "Weekly Median Price for Centered-Based Childcare ($)",
        color = "California Region"
          ) +
      scale_x_continuous(
        limits = c(2008,2018),
        breaks = seq(2008, 2018, 2)
      ) +
      theme(
        aspect.ratio = 1,
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 8), 
        plot.title = element_text(size = 10),
        legend.text = element_text(size = 8),
        legend.title = element_text(size = 10),
        legend.key.size = unit(0.4, "cm"),  
        legend.key.height = unit(0.4, "cm"),      
        legend.key.width  = unit(0.4, "cm"),
        panel.grid.major = element_line(color = "gray90", linewidth = 0.55),
        panel.grid.minor = element_line(color = "gray90", linewidth = 0.2),
        panel.background = element_rect(fill = "white")
      )
```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1
# Lab 10 - Q1 (Revised to have input checks)

randomBabies <- function(n_babies){
  stopifnot("input must be a numeric!" = is.numeric(n_babies),
            "input must be greater than 1!" = length(n_babies) == 1)
  returned <- sample(1:n_babies, size = n_babies, replace = FALSE)
  sum(returned == 1:n_babies)
}

set.seed(6767)

results <- map_int(.x = 1:10000,
                   .f = ~randomBabies(n_babies = 4) 
                  )
```

-   Example 2

```{r}
#| label: dsm-1-2
# Lab 10 - Q8 (Revised for the function to have comments)

mycifun <- function(beta0, beta1, n) {
  # NOTE: Intercept is Beta0 & Slope is Beta1
  
  # Generate x vector
  x <- runif(n, min = 0, max = 1)
  # Generate Noise Vector
  ep <- rnorm(n, mean = 0, sd = 1)
  # response variable generation from population model
  y <- beta0 + beta1 * x + ep
  
  # Make Dataframe
  dat <- tibble(x = x, y = y)
  mod <- lm(y ~ x, data = dat)
  
  slope_row <- tidy(mod, conf.int = TRUE) |>
    filter(term == "x") |>
    mutate(cover = as.integer(conf.low <= beta1 & conf.high >= beta1)) |>
    select(
      slope_estimate = estimate,
      ci_lower  = conf.low,
      ci_upper  = conf.high,
      cover
    )
  slope_row
}

# Q10
set.seed(2001)
ci_dat <- map(.x = 1:1000,
              .f = ~ mycifun(beta0 = 3, beta1 = 0.5, n = 100)
              )
# Q11
ci_dat <- bind_rows(ci_dat)
```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1
# Challenge 3 - Q3 
chisq.test(
  x = teacher_evals_compare$SET_level,
  y = teacher_evals_compare$sen_level
) 

```

-   Example 2

```{r}
#| label: dsm-2-2
# Lab 2 - Q17
species_mod <- aov(weight ~ species, data = surveys)
summary(species_mod)

```

-   Example 3

```{r}
#| label: dsm-2-3

# Lab 1 - T Test Conclusion
t.test(len ~ supp, data = ToothGrowth,
       var.equal = FALSE,   # assume unequal variances
       alternative = "two.sided")

```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

I found myself revising my thinking throughout this course not only on specific assignments but in overall approach to problem-solving. Coming in as a fourth year Computer Science student, I was already familiar with many of the technical concepts through classes such as Databases and Theory of Computation. However, what those classes did not emphasize, and what this course uniquely challenged me to develop, was how to visualize my work, communicate my reasoning, and approach technical problems with storytelling and clarity in mind. Revising my assignments involved more for me than the simple incorporation of feedback. I reflected on why a revision was necessary and where my initial thinking was lacking. For instance, in the various code examples initially included in my portfolio, I realized there were more intuitive or efficient approaches that better aligned with the learning objectives. By asking myself questions like "What do I ultimately want this table to communicate?", "What tools do I have?", and "Is there a clearer or more elegant way to express this logic?", I moved away from default or naïve solutions and toward more intentional, thoughtful ones. This helped me understand not just the corrections but the reasoning behind them, thereby improving the quality of my subsequent work.

<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

I extended my thinking in this course by pushing myself to become what some programmers jokingly call a “lazy coder”... not in effort, but in philosophy. The idea is to always seek solutions that are efficient, optimized, and thoughtfully designed so that the code works smarter, not harder. This mindset encouraged me to re-evaluate initial approaches, explore challenge problems, and incorporate new techniques into my assignments. The feedback I received on my labs and challenges was especially valuable. I treated each comment as an opportunity to grow, recognizing that the first version of a solution is rarely the strongest. While building this portfolio, there were moments where I initially struggled to find examples that demonstrated certain learning criteria. Instead of forcing weak examples, I revisited older work, refined my logic, and strengthened my explanations so my portfolio genuinely reflected growth. Another example, would be how I incorporated feedback into future assignments, like using case_when, named inputs, and across() to increase readability and reduce redundancy. This process helped fill gaps in my understanding and reinforced the wide range of tools and methods we explored throughout the course.

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

![*Collaborating on Discord for Assignment 3*](images/discord_message.png){fig-align="center"}

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->

One of the most meaningful aspects of this class has been collaboration. The weekly pair programming sessions showed me the importance of patience, communication, and the ability to support one another-skills essential in both learning and a real technical workplace. One example I am most proud of is the feedback given on Discord in Assignment 3. I aimed to give constructive, specific, and encouraging guidance that would make my peers reflect on how they could approach their problems rather than giving them the answer. Having worked as an ISA, I can understand the value of creating a learning environment where people feel comfortable asking questions and exploring ideas. These collaborative activities challenged me to explain concepts clearly, listen actively, and remain open to alternative viewpoints. I made a conscious effort to be respectful, patient, and solution focused in discussions. Whether giving detailed peer-code reviews, participating in conversations on Discord, or working through challenges together in class, I worked to elevate my peers and contribute meaningfully in our shared learning experience.
